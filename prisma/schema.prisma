generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String         @id @unique // Generated in backend as MBxxxx
  name         String
  email        String         @unique
  status       UserStatus     @default(ACTIVE)
  loans        Loan[]
  createdAt    DateTime       @default(now())
  role         UserRole       @default(CUSTOMER)
  UserIdentity UserIdentity[]
}

model UserIdentity {
  id               String   @id @default(cuid())
  contact          String
  firstName        String
  lastName         String
  dateOfBirth      DateTime
  nationalId       String
  utilityBill      String
  residencyAddress String
  stateResidency   String
  nextOfKinName    String
  nextOfKinContact String
  userId           String
  user             User     @relation(fields: [userId], references: [id])
  createdAt        DateTime @default(now())
}

model Loan {
  id            String      @id @default(cuid())
  amount        Int
  tenureDays    Int
  status        String
  loanType      String
  disbursedDate DateTime?
  customer      User        @relation(fields: [customerId], references: [id])
  customerId    String
  repayments    Repayment[]
  createdAt     DateTime    @default(now())
}

model Repayment {
  id        String   @id @default(cuid())
  amount    Int
  date      DateTime
  method    String
  status    String
  loan      Loan     @relation(fields: [loanId], references: [id])
  loanId    String
  createdAt DateTime @default(now())
}

enum UserRole {
  ADMIN
  CUSTOMER
}

enum UserStatus {
  ACTIVE
  INACTIVE
  FLAGGED
}

enum LoanType {
  CASH
  ASSET
}
